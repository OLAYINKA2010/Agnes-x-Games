<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - Agnes X Games</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/auth.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <div class="auth-logo">
                    <i class="fas fa-brain"></i>
                    <span>Agnes X Games</span>
                </div>
                <h1 class="auth-title">Create Account</h1>
                <p class="auth-subtitle">Join our cognitive training community</p>
            </div>

            <form id="signupForm" class="auth-form">
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" required 
                           placeholder="your.email@gmail.com">
                    <div class="error-message" id="emailError"></div>
                </div>

                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" required 
                           placeholder="Choose a username">
                    <div class="error-message" id="usernameError"></div>
                </div>

                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required 
                           placeholder="Create a strong password">
                    <div class="password-strength">
                        <div class="strength-meter" id="passwordStrength"></div>
                    </div>
                    <div class="error-message" id="passwordError"></div>
                </div>

                <div class="form-group">
                    <label for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" required 
                           placeholder="Re-enter your password">
                    <div class="error-message" id="confirmPasswordError"></div>
                </div>

                <div class="form-group">
                    <label class="remember-me">
                        <input type="checkbox" id="terms" required>
                        <span>I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a></span>
                    </label>
                    <div class="error-message" id="termsError"></div>
                </div>

                <button type="submit" class="auth-btn" id="signupBtn">
                    <span id="btnText">Create Account</span>
                    <div class="loading-spinner" id="loadingSpinner" style="display: none;"></div>
                </button>
            </form>

            <div class="auth-divider">
                <span>Or continue with</span>
            </div>

            <button class="gmail-btn" onclick="signInWithGmail()">
                <i class="fab fa-google"></i>
                Sign up with Gmail
            </button>

            <div class="auth-footer">
                <p>Already have an account? <a href="login.html" class="auth-link">Sign In</a></p>
            </div>
        </div>
    </div>
    <script>
        document.getElementById("signupForm").addEventListener("submit", async function (e) {
    e.preventDefault(); // Prevent page refresh

    // Get form values
    const email = document.getElementById("email").value.trim();
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();
    const confirmPassword = document.getElementById("confirmPassword").value.trim();
    const terms = document.getElementById("terms").checked;

    // Basic validation
    if (!terms) {
        document.getElementById("termsError").innerText = "You must agree to the terms.";
        return;
    } else {
        document.getElementById("termsError").innerText = "";
    }

    if (password !== confirmPassword) {
        document.getElementById("confirmPasswordError").innerText = "Passwords do not match!";
        return;
    } else {
        document.getElementById("confirmPasswordError").innerText = "";
    }

    // Show loading animation
    document.getElementById("btnText").style.display = "none";
    document.getElementById("loadingSpinner").style.display = "block";

    // Payload for backend
    const userData = {
        email,
        username,
        password
    };

    try {
        // Change this URL to your backend API endpoint
        const response = await fetch("https://your-backend-url.com/api/signup", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(userData)
        });

        const result = await response.json();

        if (response.ok) {
            alert("Account created successfully!");
            window.location.href = "login.html";  // Redirect to login page
        } else {
            alert(result.message || "Signup failed. Try again.");
        }
    } catch (error) {
        console.error("Error:", error);
        alert("Something went wrong. Check your internet or server.");
    }

    // Hide loading spinner
    document.getElementById("btnText").style.display = "block";
    document.getElementById("loadingSpinner").style.display = "none";
});

// js/signup.js

document.getElementById("signupForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const email = document.getElementById("email").value.trim();
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();
    const confirmPassword = document.getElementById("confirmPassword").value.trim();

    if (password !== confirmPassword) {
        document.getElementById("confirmPasswordError").innerText = "Passwords do not match!";
        return;
    }

    // check if user already exists
    let users = JSON.parse(localStorage.getItem("users")) || [];

    const exists = users.find(u => u.email === email);
    if (exists) {
        alert("This email is already registered!");
        return;
    }

    // save new user
    users.push({ email, username, password });
    localStorage.setItem("users", JSON.stringify(users));

    alert("Signup Successful!");
    window.location.href = "login.html";
});

    </script>
    <script src="js/auth.js"></script>
</body>
</html>